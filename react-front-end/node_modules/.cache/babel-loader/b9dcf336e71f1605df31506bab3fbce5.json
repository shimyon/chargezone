{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Row,FormGroup,Card,CardBody,Label,Input,Button,Alert}from'reactstrap';import{Colxx,Separator}from'../../../components/common/CustomBootstrap';import{getCurrentUser}from'../../../helpers/Utils';import{adminRoot,getOemAPI,addFaultAPI}from'../../../constants/defaultValues';import axios from'axios';import{Formik}from'formik';import*as yup from'yup';import{useHistory}from\"react-router-dom\";const AddFault=()=>{const history=useHistory();//dropdown state\nconst _useState=useState([]),_useState2=_slicedToArray(_useState,2),oemList=_useState2[0],setOemList=_useState2[1];const _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),oemId=_useState4[0],setOemId=_useState4[1];const _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),type=_useState6[0],setType=_useState6[1];//error flags\nconst _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),errorTypeFlag=_useState8[0],setErrorTypeFlag=_useState8[1];const _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),errorOemFlag=_useState10[0],setErrorOemFlag=_useState10[1];//alert states\nconst _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),alertVisible=_useState12[0],setAlertVisible=_useState12[1];const _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),alertMsg=_useState14[0],setAlertMsg=_useState14[1];const _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),alertColor=_useState16[0],setAlertColor=_useState16[1];//state to disable button on click\nconst _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),buttonDisabled=_useState18[0],setButtonDisabled=_useState18[1];//API calls\nconst getOemAPICall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(typeId){var currentUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setAlertVisible(false);currentUser=getCurrentUser();_context.next=4;return axios.post(getOemAPI,{type:typeId},{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){setOemList(responseData.data);}else{setOemList([]);faultAddedAlert(\"OEM data for selectd type not found\");}}).catch(error=>{console.log(error);});case 4:case\"end\":return _context.stop();}},_callee);}));return function getOemAPICall(_x){return _ref.apply(this,arguments);};}();const addFaultAPICall=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(params){var currentUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setButtonDisabled(true);currentUser=getCurrentUser();_context2.next=4;return axios.post(addFaultAPI,params,{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){history.push({pathname:adminRoot+'/pages/fault',state:{responseStatus:responseData.status,responseMsg:responseData.msg}});}else{setButtonDisabled(false);faultAddedAlert(responseData.msg);}}).catch(error=>{setButtonDisabled(false);console.log(error);});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function addFaultAPICall(_x2){return _ref2.apply(this,arguments);};}();//helper methods\n//Alert helper methods\nconst faultAddedAlert=msg=>{setAlertVisible(true);setAlertMsg(msg);setAlertColor(\"danger\");};const onDismissAlert=()=>{setAlertVisible(false);};//type select method\nconst handleTypeSelect=typeValue=>{setOemId(\"\");setType(typeValue);if(typeValue==4){getOemAPICall(3);}else{getOemAPICall(typeValue);}};//type blur\nconst handleTypeBlur=typeValue=>{setErrorTypeFlag(false);if(typeValue==0){setErrorTypeFlag(true);}};//OEM select method\nconst handleOemSelect=oemValue=>{if(oemValue==0){setOemId(\" \");}else{setOemId(oemValue);}};//oem blur\nconst handleOemBlur=oemValue=>{setErrorOemFlag(false);if(oemValue==0){setErrorOemFlag(true);}};//Form Validation Schema\nconst FaultDetailsValidationSchema=yup.object().shape({title:yup.string().required(\"Fault title is required\"),bit_position:yup.string().required(\"Position is required\")});const initialValues={title:\"\",bit_position:\"\"};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\"},/*#__PURE__*/React.createElement(\"span\",{className:\"page_title\"},\"Add Fault\"),/*#__PURE__*/React.createElement(\"a\",{href:\"fault\",className:\"mt-2 btn-primary default btn-sm float-right\"},/*#__PURE__*/React.createElement(\"b\",null,/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-list\"}),\" Fault List\")),/*#__PURE__*/React.createElement(Separator,{className:\"mb-5 mt-1\"}))),/*#__PURE__*/React.createElement(Formik,{initialValues:initialValues,validationSchema:FaultDetailsValidationSchema,onSubmit:values=>{const params={type:type,title:values.title,bit_position:values.bit_position,oem_id:oemId};addFaultAPICall(params);}},({handleChange,handleBlur,handleSubmit,values,touched,errors})=>/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\",className:\"mb-4\"},/*#__PURE__*/React.createElement(Card,{className:\"mb-4\"},/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{md:\"12\"},/*#__PURE__*/React.createElement(Alert,{color:alertColor,isOpen:alertVisible,toggle:onDismissAlert},alertMsg)),/*#__PURE__*/React.createElement(Colxx,{sm:6},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Type\"),/*#__PURE__*/React.createElement(Input,{type:\"select\",name:\"type\",value:type,onChange:e=>handleTypeSelect(e.target.value),onBlur:e=>handleTypeBlur(e.target.value)},/*#__PURE__*/React.createElement(\"option\",{key:0,value:0},\"Select\"),/*#__PURE__*/React.createElement(\"option\",{key:1,value:1},\"Battery\"),/*#__PURE__*/React.createElement(\"option\",{key:2,value:2},\"EV\"),/*#__PURE__*/React.createElement(\"option\",{key:3,value:3},\"Charger\"),/*#__PURE__*/React.createElement(\"option\",{key:4,value:4},\"Connector\")),errorTypeFlag&&/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},\"Type is required\"))),/*#__PURE__*/React.createElement(Colxx,{sm:6},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"OEM\"),/*#__PURE__*/React.createElement(Input,{type:\"select\",name:\"oem_id\",value:oemId,onChange:e=>handleOemSelect(e.target.value),onBlur:e=>handleOemBlur(e.target.value)},/*#__PURE__*/React.createElement(\"option\",{key:0,value:0},\"Select\"),oemList.map(item=>/*#__PURE__*/React.createElement(\"option\",{key:item.oem_id,value:item.oem_id},item.name))),errorOemFlag&&/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},\"OEM is required\"))),/*#__PURE__*/React.createElement(Colxx,{md:6},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Fault Title\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",placeholder:\"Fault title \",name:\"title\",value:values.title,onChange:handleChange,onBlur:handleBlur,className:errors.title&&touched.title?\"input-error\":null}),errors.title&&touched.title&&/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors.title))),/*#__PURE__*/React.createElement(Colxx,{md:6},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,null,\"Position\"),/*#__PURE__*/React.createElement(Input,{type:\"number\",placeholder:\"Position \",name:\"bit_position\",value:values.bit_position,onChange:handleChange,onBlur:handleBlur,className:errors.bit_position&&touched.bit_position?\"input-error\":null}),errors.bit_position&&touched.bit_position&&/*#__PURE__*/React.createElement(\"span\",{className:\"error\"},errors.bit_position)))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{md:\"12\",className:\"text-center\"},/*#__PURE__*/React.createElement(Button,{color:\"primary\",className:\"default mr-2\",onClick:handleSubmit,disabled:buttonDisabled},/*#__PURE__*/React.createElement(\"b\",null,\"Add\")),/*#__PURE__*/React.createElement(Button,{color:\"light\",className:\"default\",onClick:()=>{history.goBack();}},/*#__PURE__*/React.createElement(\"b\",null,\"Cancel\")))))))))));};export default AddFault;","map":{"version":3,"sources":["D:/Shimyon/Emoiss/RiteshBhai/cdzb/chargezone-frontend-development/src/views/app/pages/AddFault.js"],"names":["React","useState","useEffect","Row","FormGroup","Card","CardBody","Label","Input","Button","Alert","Colxx","Separator","getCurrentUser","adminRoot","getOemAPI","addFaultAPI","axios","Formik","yup","useHistory","AddFault","history","oemList","setOemList","oemId","setOemId","type","setType","errorTypeFlag","setErrorTypeFlag","errorOemFlag","setErrorOemFlag","alertVisible","setAlertVisible","alertMsg","setAlertMsg","alertColor","setAlertColor","buttonDisabled","setButtonDisabled","getOemAPICall","typeId","currentUser","post","headers","Authorization","token","then","response","responseData","data","status","faultAddedAlert","catch","error","console","log","addFaultAPICall","params","push","pathname","state","responseStatus","responseMsg","msg","onDismissAlert","handleTypeSelect","typeValue","handleTypeBlur","handleOemSelect","oemValue","handleOemBlur","FaultDetailsValidationSchema","object","shape","title","string","required","bit_position","initialValues","values","oem_id","handleChange","handleBlur","handleSubmit","touched","errors","e","target","value","map","item","name","goBack"],"mappings":"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","sourcesContent":["import React, { useState,useEffect } from 'react';\nimport { \n  Row,FormGroup, Card, CardBody,\n  Label,Input, Button,Alert\n } from 'reactstrap';\nimport { Colxx, Separator } from '../../../components/common/CustomBootstrap';\nimport { getCurrentUser } from '../../../helpers/Utils'\nimport {adminRoot,getOemAPI,addFaultAPI} from '../../../constants/defaultValues'\nimport axios from 'axios';\nimport {Formik} from 'formik';\nimport * as yup from 'yup';\nimport { useHistory } from \"react-router-dom\";\n\nconst AddFault = () => {\n  const history = useHistory();\n  //dropdown state\n  const [oemList,setOemList] = useState([]);\n  const [oemId,setOemId] = useState(\"\");\n  const [type,setType] = useState(\"\");\n  //error flags\n  const [errorTypeFlag,setErrorTypeFlag] = useState(false);\n  const [errorOemFlag,setErrorOemFlag] = useState(false);\n  //alert states\n  const [alertVisible,setAlertVisible] = useState(false);\n  const [alertMsg,setAlertMsg] = useState(\"\");\n  const [alertColor,setAlertColor] = useState(\"\");\n  //state to disable button on click\n  const [buttonDisabled,setButtonDisabled] = useState(false);\n\n  //API calls\n  const getOemAPICall = async(typeId) => {\n    setAlertVisible(false);\n    const currentUser = getCurrentUser();\n    await axios.post(getOemAPI,\n      {type:typeId},\n      {headers:{Authorization: `Bearer ${currentUser.token}`}})\n      .then(response=>{\n        const responseData = response.data;\n        if (responseData.status === 1) {          \n          setOemList(responseData.data);\n        }else{\n          setOemList([]);\n          faultAddedAlert(\"OEM data for selectd type not found\");\n        }\n      }).catch(error=>{\n        console.log(error);\n      })\n  }\n  const addFaultAPICall = async(params) => {\n    setButtonDisabled(true);\n    const currentUser = getCurrentUser();\n    await axios.post(addFaultAPI,\n      params,\n      {headers:{Authorization: `Bearer ${currentUser.token}`}})\n      .then(response=>{\n        const responseData = response.data;\n        if (responseData.status === 1) {\n          history.push({\n            pathname:adminRoot+'/pages/fault',\n            state:{\n              responseStatus:responseData.status,\n              responseMsg:responseData.msg\n            }\n          })\n        }else{\n          setButtonDisabled(false);\n          faultAddedAlert(responseData.msg);\n        }\n      }).catch(error=>{\n        setButtonDisabled(false);\n        console.log(error);\n      })\n  }\n\n  //helper methods\n  //Alert helper methods\n  const faultAddedAlert = (msg)=>{\n    setAlertVisible(true);\n    setAlertMsg(msg);\n    setAlertColor(\"danger\");\n  }\n  const onDismissAlert = ()=>{\n    setAlertVisible(false);\n  }\n  //type select method\n  const handleTypeSelect = (typeValue) => {\n    setOemId(\"\");\n    setType(typeValue);\n    if (typeValue == 4) {\n      getOemAPICall(3);\n    } else {\n      getOemAPICall(typeValue); \n    }\n  }\n  //type blur\n  const handleTypeBlur = (typeValue) => {\n    setErrorTypeFlag(false);\n    if (typeValue == 0) {\n      setErrorTypeFlag(true);\n    }\n  }\n  //OEM select method\n  const handleOemSelect = (oemValue) => {\n    if (oemValue == 0) {\n      setOemId(\" \");\n    } else {\n      setOemId(oemValue); \n    }\n  }\n  //oem blur\n  const handleOemBlur = (oemValue) => {\n    setErrorOemFlag(false);\n    if (oemValue == 0) {\n      setErrorOemFlag(true);\n    }\n  }\n  //Form Validation Schema\n  const FaultDetailsValidationSchema = yup.object().shape({\n    title:yup.string()\n        .required(\"Fault title is required\"),\n    bit_position:yup.string()\n        .required(\"Position is required\"),\n  });\n\n  const initialValues = {\n    title:\"\",\n    bit_position:\"\",\n  };\n\n\n  return (\n    <>\n      <Row>\n        <Colxx xxs=\"12\">\n            <span className=\"page_title\">Add Fault</span>\n            <a href=\"fault\" className=\"mt-2 btn-primary default btn-sm float-right\">\n                <b><i className=\"glyph-icon simple-icon-list\"></i> Fault List</b>\n            </a>\n          <Separator className=\"mb-5 mt-1\" />\n        </Colxx>\n      </Row>\n      <Formik\n        initialValues={initialValues}\n        validationSchema={FaultDetailsValidationSchema} \n        onSubmit={(values)=>{\n          const params = {\n            type:type,\n            title:values.title,\n            bit_position:values.bit_position,\n            oem_id:oemId\n          }\n          addFaultAPICall(params);\n        }} >\n          {({handleChange,handleBlur,handleSubmit,values,touched,errors})=>(\n            <>\n              <Row>\n                <Colxx xxs=\"12\" className=\"mb-4\">\n                  <Card className=\"mb-4\">\n                      <CardBody> \n                        <Row>\n                          <Colxx md=\"12\">\n                            <Alert color={alertColor} isOpen={alertVisible} toggle={onDismissAlert}>\n                              {alertMsg}\n                            </Alert>\n                          </Colxx>\n                          <Colxx sm={6}>\n                            <FormGroup>\n                              <Label>\n                                Type\n                              </Label>\n                              <Input \n                              type=\"select\" \n                              name=\"type\"\n                              value={type}\n                              onChange={(e)=>handleTypeSelect(e.target.value)}\n                              onBlur={(e)=>handleTypeBlur(e.target.value)}>\n                                  <option key={0} value={0}>Select</option>\n                                  <option key={1} value={1}>Battery</option>\n                                  <option key={2} value={2}>EV</option>\n                                  <option key={3} value={3}>Charger</option>\n                                  <option key={4} value={4}>Connector</option>\n                              </Input>\n                              {errorTypeFlag &&(\n                                  <span className=\"error\">Type is required</span>\n                                )}  \n                              </FormGroup>\n                            </Colxx>\n                            <Colxx sm={6}>\n                              <FormGroup>\n                                <Label>\n                                  OEM\n                                </Label>\n                                <Input \n                                type=\"select\"\n                                name=\"oem_id\"\n                                value={oemId}\n                                onChange={(e)=>handleOemSelect(e.target.value)}\n                                onBlur={(e)=>handleOemBlur(e.target.value)}>\n                                    <option key={0} value={0}>Select</option>\n                                    {oemList.map(item=>\n                                      <option key={item.oem_id} value={item.oem_id}>{item.name}</option>\n                                    )}\n                                </Input>\n                                {errorOemFlag &&(\n                                    <span className=\"error\">OEM is required</span>\n                                  )}   \n                              </FormGroup>\n                            </Colxx>\n                            <Colxx md={6}>\n                              <FormGroup>\n                                <Label>\n                                  Fault Title\n                                </Label>\n                                <Input\n                                  type=\"text\"\n                                  placeholder=\"Fault title \"\n                                  name=\"title\"\n                                  value={values.title}\n                                  onChange={handleChange}\n                                  onBlur={handleBlur}\n                                  className={errors.title && touched.title ? \"input-error\":null}\n                                />\n                                {errors.title && touched.title &&(\n                                  <span className=\"error\">{errors.title}</span>\n                                )}  \n                              </FormGroup>\n                            </Colxx>\n                            <Colxx md={6}>\n                              <FormGroup>\n                                <Label>\n                                  Position\n                                </Label>\n                                <Input\n                                  type=\"number\"\n                                  placeholder=\"Position \"\n                                  name=\"bit_position\"\n                                  value={values.bit_position}\n                                  onChange={handleChange}\n                                  onBlur={handleBlur}\n                                  className={errors.bit_position && touched.bit_position ? \"input-error\":null}\n                                />\n                                {errors.bit_position && touched.bit_position &&(\n                                  <span className=\"error\">{errors.bit_position}</span>\n                                )}  \n                              </FormGroup>\n                            </Colxx>\n                          </Row>\n                          <Row>\n                            <Colxx md=\"12\" className=\"text-center\">\n                              <Button color=\"primary\" className=\"default mr-2\" onClick={handleSubmit} disabled={buttonDisabled}>\n                                  <b>Add</b>\n                              </Button>\n                              <Button color=\"light\" className=\"default\" onClick={()=>{history.goBack()}}>\n                                  <b>Cancel</b>\n                              </Button>\n                            </Colxx>\n                          </Row>\n                      </CardBody>\n                      </Card>\n                </Colxx>\n              </Row>\n            </>\n          )}\n      </Formik>  \n    </>\n  );\n};\n\nexport default AddFault;\n"]},"metadata":{},"sourceType":"module"}