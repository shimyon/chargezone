{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Row,DropdownItem,DropdownMenu,DropdownToggle,UncontrolledButtonDropdown}from'reactstrap';import{Colxx,Separator}from'../../../components/common/CustomBootstrap';import{getStationsAPI,getDashboardDataAPI}from'../../../constants/defaultValues';import{getCurrentUser}from'../../../helpers/Utils';import axios from'axios';import{ThemeColors}from'../../../helpers/ThemeColors';import{ChargerDoughnut,setChargerChartData}from'./operator/ChargerDoughnut';import{ConnectorDoughnut,setConnectorChartData}from'./operator/ConnectorDoughnut';import{BatteryStatusChart,setBatteryChartData}from'./operator/BatteryStatusChart';import{IconCardsCarousel,setBatteriesCount,setChargerCount,setConnectorCount,setEVCount,setStationCount}from'./manager/cardCarousel';import{SwapChartCard,setSwapChartData,setshowSwapChart}from'./manager/SwapChart';import{EnergyChartCard,setEnergyChartData,setshowEnergyChart}from'./manager/EnergyChart';import{KPICards,setKPIChartData}from'./manager/KPICards';import{StationDoughnut,setStationChartData}from'./manager/StationDoughnut';const colors=ThemeColors();const Mgr_dashboard=()=>{//All station names\nconst _useState=useState([]),_useState2=_slicedToArray(_useState,2),stationNameData=_useState2[0],setStationNameData=_useState2[1];//Swapping useStates\nconst _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),swappingChartData=_useState4[0],setSwappingChartData=_useState4[1];//swapping chart data\nconst _useState5=useState(\"All Stations\"),_useState6=_slicedToArray(_useState5,2),swappingDropHeader=_useState6[0],setSwappingDropHeader=_useState6[1];//swapping dropdown header\nconst _useState7=useState('0'),_useState8=_slicedToArray(_useState7,2),swappingStation=_useState8[0],setSwappingStation=_useState8[1];//swapping chart dropdown\n//Batteries useStates\n//Chargers useStates\nconst _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),chargerData=_useState10[0],setChargerData=_useState10[1];//charger card and chart data\nconst _useState11=useState('0'),_useState12=_slicedToArray(_useState11,2),chargerStation=_useState12[0],setChargerStation=_useState12[1];//chargers chart dropdown\n//Slots useState\nconst _useState13=useState('0'),_useState14=_slicedToArray(_useState13,2),slotStation=_useState14[0],setSlotStation=_useState14[1];//slots chart dropdown\nuseEffect(()=>{GetStationNamesAPICall();},[]);useEffect(()=>{GetDashboardDataAPICall();},[swappingStation,chargerStation,slotStation]);//API call\nconst GetStationNamesAPICall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var currentUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:currentUser=getCurrentUser();_context.next=3;return axios.get(getStationsAPI,{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){//stationNamesData = responseData.data;\nsetStationNameData(responseData.data);}else{console.log(responseData.msg);}}).catch(error=>{console.log(error);});case 3:case\"end\":return _context.stop();}},_callee);}));return function GetStationNamesAPICall(){return _ref.apply(this,arguments);};}();const GetDashboardDataAPICall=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var currentUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:currentUser=getCurrentUser();_context2.next=3;return axios.post(getDashboardDataAPI,{station_id:swappingStation},{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){setshowEnergyChart(true);setshowSwapChart(true);setStationCount(responseData.data.station.total);setBatteriesCount(responseData.data.batteries.total);setChargerCount(responseData.data.chargers.total);setEVCount(responseData.data.ev.total);setConnectorCount(responseData.data.slots.total);setBatteryChartData(0,responseData.data.batteries.total,responseData.data.batteries.in_charging);setBatteryChartData(1,responseData.data.batteries.total,responseData.data.batteries.charged);setBatteryChartData(2,responseData.data.batteries.total,responseData.data.batteries.discharged);setBatteryChartData(3,responseData.data.batteries.total,responseData.data.batteries.faulty);setBatteryChartData(4,responseData.data.batteries.total,responseData.data.batteries.out);setChargerChartData(responseData.data.chargers.operational,responseData.data.chargers.faulty);setConnectorChartData(responseData.data.slots.inuse,responseData.data.slots.available,responseData.data.slots.faulty);setStationChartData(responseData.data.station.operational,responseData.data.station.faulty);setChargerData(responseData.data.chargers);setEnergyChartData(responseData);setSwapChartData(responseData);setKPIChartData(0,abbreviateNumber(responseData.data.energy_sold.cumulative),abbreviateNumber(responseData.data.misc.unit_30)+\" in last 30 days\");setKPIChartData(1,abbreviateNumber(responseData.data.energy_sold.avg_unit_per_ev_per_day),\"\");setKPIChartData(2,responseData.data.swapping.daily,abbreviateNumber(responseData.data.misc.swap_30)+\" in last 30 days\");setSwappingChartData({labels:responseData.data.swapping.date,datasets:[{label:'Complete',data:responseData.data.swapping.complete_swap_data,borderColor:colors.themeColor1,pointBackgroundColor:colors.foregroundColor,pointBorderColor:colors.themeColor1,pointHoverBackgroundColor:colors.themeColor1,pointHoverBorderColor:colors.foregroundColor,pointRadius:6,pointBorderWidth:2,pointHoverRadius:8,fill:false},{label:'Incomplete',data:responseData.data.swapping.incomplete_swap_data,borderColor:colors.themeColor2,pointBackgroundColor:colors.foregroundColor,pointBorderColor:colors.themeColor2,pointHoverBackgroundColor:colors.themeColor2,pointHoverBorderColor:colors.foregroundColor,pointRadius:6,pointBorderWidth:2,pointHoverRadius:8,fill:false}]});}else{console.log(responseData.msg);}}).catch(error=>{console.log(error);});case 3:case\"end\":return _context2.stop();}},_callee2);}));return function GetDashboardDataAPICall(){return _ref2.apply(this,arguments);};}();const abbreviateNumber=num=>{let fixed=0;if(num===null){return null;}// terminate early\nif(num===0){return'0';}// terminate early\nfixed=!fixed||fixed<0?0:fixed;// number of decimal places to show\nvar b=num.toPrecision(2).split(\"e\"),// get power\nk=b.length===1?0:Math.floor(Math.min(b[1].slice(1),14)/3),// floor at decimals, ceiling at trillions\nc=k<1?num.toFixed(0+fixed):(num/Math.pow(10,k*3)).toFixed(1+fixed),// divide by power\nd=c<0?c:Math.abs(c),// enforce -0 is 0\ne=d+['','K','M','B','T'][k];// append power\nreturn e;};//dropdown handle methods\n//swapping dropdown\nconst handleSwappingStationSelect=e=>{setSwappingDropHeader(e.currentTarget.textContent);setSwappingStation(e.target.value);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\"},/*#__PURE__*/React.createElement(\"span\",{className:\"page_title\"},\"Manager Dashboard\"),/*#__PURE__*/React.createElement(\"div\",{className:\"btn-group float-right float-none-xs \"},/*#__PURE__*/React.createElement(UncontrolledButtonDropdown,null,/*#__PURE__*/React.createElement(DropdownToggle,{caret:true,color:\"primary\"},swappingDropHeader),/*#__PURE__*/React.createElement(DropdownMenu,null,/*#__PURE__*/React.createElement(DropdownItem,{header:true},\"Stations\"),/*#__PURE__*/React.createElement(DropdownItem,{key:0,value:0,onClick:e=>handleSwappingStationSelect(e)},\"All Stations\"),stationNameData.map((item,i)=>/*#__PURE__*/React.createElement(DropdownItem,{key:i,value:item.hub_master_id,onClick:e=>handleSwappingStationSelect(e)},item.name))))),/*#__PURE__*/React.createElement(Separator,{className:\"mb-5\"}))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{lg:\"12\",xl:\"12\",md:\"12\"},/*#__PURE__*/React.createElement(IconCardsCarousel,null))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{lg:\"5\",xxs:\"12\",className:\"mb-5\"},/*#__PURE__*/React.createElement(SwapChartCard,null)),/*#__PURE__*/React.createElement(Colxx,{lg:\"2\",xxs:\"12\",className:\"mb-2\"},/*#__PURE__*/React.createElement(KPICards,null)),/*#__PURE__*/React.createElement(Colxx,{lg:\"5\",xxs:\"12\",className:\"mb-5\"},/*#__PURE__*/React.createElement(EnergyChartCard,null))),/*#__PURE__*/React.createElement(Row,{className:\"mb-12\"},/*#__PURE__*/React.createElement(Colxx,{sm:\"12\",md:\"6\",lg:\"3\",className:\"mb-3\"},/*#__PURE__*/React.createElement(StationDoughnut,null)),/*#__PURE__*/React.createElement(Colxx,{sm:\"12\",md:\"6\",lg:\"3\",className:\"mb-3\"},/*#__PURE__*/React.createElement(ChargerDoughnut,null)),/*#__PURE__*/React.createElement(Colxx,{sm:\"12\",md:\"6\",lg:\"3\",className:\"mb-3\"},/*#__PURE__*/React.createElement(BatteryStatusChart,{cardClass:\"dashboard-progress\"})),/*#__PURE__*/React.createElement(Colxx,{sm:\"12\",md:\"6\",lg:\"3\",className:\"mb-3\"},/*#__PURE__*/React.createElement(ConnectorDoughnut,null))));};export default Mgr_dashboard;","map":{"version":3,"sources":["D:/Shimyon/Emoiss/RiteshBhai/cdzb/chargezone/react-front-end/src/views/app/dashboard/Mgr_dashboard.js"],"names":["React","useState","useEffect","Row","DropdownItem","DropdownMenu","DropdownToggle","UncontrolledButtonDropdown","Colxx","Separator","getStationsAPI","getDashboardDataAPI","getCurrentUser","axios","ThemeColors","ChargerDoughnut","setChargerChartData","ConnectorDoughnut","setConnectorChartData","BatteryStatusChart","setBatteryChartData","IconCardsCarousel","setBatteriesCount","setChargerCount","setConnectorCount","setEVCount","setStationCount","SwapChartCard","setSwapChartData","setshowSwapChart","EnergyChartCard","setEnergyChartData","setshowEnergyChart","KPICards","setKPIChartData","StationDoughnut","setStationChartData","colors","Mgr_dashboard","stationNameData","setStationNameData","swappingChartData","setSwappingChartData","swappingDropHeader","setSwappingDropHeader","swappingStation","setSwappingStation","chargerData","setChargerData","chargerStation","setChargerStation","slotStation","setSlotStation","GetStationNamesAPICall","GetDashboardDataAPICall","currentUser","get","headers","Authorization","token","then","response","responseData","data","status","console","log","msg","catch","error","post","station_id","station","total","batteries","chargers","ev","slots","in_charging","charged","discharged","faulty","out","operational","inuse","available","abbreviateNumber","energy_sold","cumulative","misc","unit_30","avg_unit_per_ev_per_day","swapping","daily","swap_30","labels","date","datasets","label","complete_swap_data","borderColor","themeColor1","pointBackgroundColor","foregroundColor","pointBorderColor","pointHoverBackgroundColor","pointHoverBorderColor","pointRadius","pointBorderWidth","pointHoverRadius","fill","incomplete_swap_data","themeColor2","num","fixed","b","toPrecision","split","k","length","Math","floor","min","slice","c","toFixed","pow","d","abs","e","handleSwappingStationSelect","currentTarget","textContent","target","value","map","item","i","hub_master_id","name"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport { \n  Row,\n  DropdownItem,\n  DropdownMenu,\n  DropdownToggle,\n  UncontrolledButtonDropdown,\n } from 'reactstrap';\nimport { Colxx, Separator } from '../../../components/common/CustomBootstrap';\n\nimport {getStationsAPI,getDashboardDataAPI} from '../../../constants/defaultValues'\nimport { getCurrentUser } from '../../../helpers/Utils'\nimport axios from 'axios';\nimport { ThemeColors } from '../../../helpers/ThemeColors';\nimport {ChargerDoughnut, setChargerChartData} from './operator/ChargerDoughnut';\nimport {ConnectorDoughnut,setConnectorChartData} from './operator/ConnectorDoughnut';\nimport {BatteryStatusChart,setBatteryChartData} from './operator/BatteryStatusChart';\nimport { IconCardsCarousel, setBatteriesCount, setChargerCount, setConnectorCount, setEVCount,setStationCount } from './manager/cardCarousel';\nimport {SwapChartCard,setSwapChartData,setshowSwapChart} from './manager/SwapChart';\nimport {EnergyChartCard,setEnergyChartData, setshowEnergyChart} from './manager/EnergyChart';\nimport {KPICards,setKPIChartData} from './manager/KPICards';\nimport { StationDoughnut,setStationChartData } from './manager/StationDoughnut';\nconst colors = ThemeColors();\n\nconst Mgr_dashboard = () => {\n  //All station names\n  const [stationNameData,setStationNameData] = useState([]);\n  \n  //Swapping useStates\n  \n  const [swappingChartData,setSwappingChartData] = useState({}); //swapping chart data\n  const [swappingDropHeader,setSwappingDropHeader] = useState(\"All Stations\"); //swapping dropdown header\n  const [swappingStation,setSwappingStation] = useState('0'); //swapping chart dropdown\n  //Batteries useStates\n  \n  //Chargers useStates\n  const [chargerData,setChargerData] = useState({}); //charger card and chart data\n  \n  const [chargerStation,setChargerStation] = useState('0'); //chargers chart dropdown\n  //Slots useState\n  \n  const [slotStation,setSlotStation] = useState('0'); //slots chart dropdown\n\n\n  useEffect(()=>{\n    GetStationNamesAPICall();\n  },[])\n  useEffect(()=>{\n    GetDashboardDataAPICall();\n  },[swappingStation,chargerStation,slotStation])\n\n  //API call\n  const GetStationNamesAPICall = async() => {\n    const currentUser = getCurrentUser();\n    await axios.get(getStationsAPI,\n    {headers:{Authorization: `Bearer ${currentUser.token}`}})\n    .then(response=>{\n      const responseData = response.data;\n      if (responseData.status === 1) {\n        //stationNamesData = responseData.data;\n        setStationNameData(responseData.data)\n      }else{\n        console.log(responseData.msg);\n      }\n    }).catch(error=>{\n      console.log(error);\n    })\n  }\n\n  const GetDashboardDataAPICall = async() => {\n    const currentUser = getCurrentUser();\n    await axios.post(getDashboardDataAPI,\n    {\n     station_id:swappingStation\n    },\n    {headers:{Authorization: `Bearer ${currentUser.token}`}})\n    .then(response=>{\n      const responseData = response.data;\n      if (responseData.status === 1) {\n\n        setshowEnergyChart(true);\n        setshowSwapChart(true);\n        setStationCount(responseData.data.station.total);\n        setBatteriesCount(responseData.data.batteries.total)\n       \n        setChargerCount(responseData.data.chargers.total);\n       \n        setEVCount(responseData.data.ev.total);\n        setConnectorCount(responseData.data.slots.total);\n\n        setBatteryChartData(0,responseData.data.batteries.total,responseData.data.batteries.in_charging);\n        setBatteryChartData(1,responseData.data.batteries.total,responseData.data.batteries.charged);\n        setBatteryChartData(2,responseData.data.batteries.total,responseData.data.batteries.discharged);\n        setBatteryChartData(3,responseData.data.batteries.total,responseData.data.batteries.faulty);\n        setBatteryChartData(4,responseData.data.batteries.total,responseData.data.batteries.out);\n        \n        setChargerChartData(responseData.data.chargers.operational,responseData.data.chargers.faulty);\n        setConnectorChartData( responseData.data.slots.inuse,responseData.data.slots.available,responseData.data.slots.faulty);\n        setStationChartData(responseData.data.station.operational,responseData.data.station.faulty);\n        setChargerData(responseData.data.chargers);\n        setEnergyChartData(responseData);\n        setSwapChartData(responseData);\n       \n        setKPIChartData(0,abbreviateNumber(responseData.data.energy_sold.cumulative),abbreviateNumber(responseData.data.misc.unit_30)+\" in last 30 days\");\n        setKPIChartData(1,abbreviateNumber(responseData.data.energy_sold.avg_unit_per_ev_per_day),\"\");\n        setKPIChartData(2,responseData.data.swapping.daily,abbreviateNumber(responseData.data.misc.swap_30)+\" in last 30 days\");\n\n        setSwappingChartData({\n          labels: responseData.data.swapping.date,\n          datasets: [\n            {\n              label: 'Complete',\n              data: responseData.data.swapping.complete_swap_data,\n              borderColor: colors.themeColor1,\n              pointBackgroundColor: colors.foregroundColor,\n              pointBorderColor: colors.themeColor1,\n              pointHoverBackgroundColor: colors.themeColor1,\n              pointHoverBorderColor: colors.foregroundColor,\n              pointRadius: 6,\n              pointBorderWidth: 2,\n              pointHoverRadius: 8,\n              fill: false,\n            },\n            {\n              label: 'Incomplete',\n              data: responseData.data.swapping.incomplete_swap_data,\n              borderColor: colors.themeColor2,\n              pointBackgroundColor: colors.foregroundColor,\n              pointBorderColor: colors.themeColor2,\n              pointHoverBackgroundColor: colors.themeColor2,\n              pointHoverBorderColor: colors.foregroundColor,\n              pointRadius: 6,\n              pointBorderWidth: 2,\n              pointHoverRadius: 8,\n              fill: false,\n            },\n        ],\n        });\n               \n      }else{\n        console.log(responseData.msg);\n      }\n    }).catch(error=>{\n      console.log(error);\n    })\n  }\n\n  const abbreviateNumber =(num)=>{\n   let fixed=0;\n    if (num === null) { return null; } // terminate early\n  if (num === 0) { return '0'; } // terminate early\n  fixed = (!fixed || fixed < 0) ? 0 : fixed; // number of decimal places to show\n  var b = (num).toPrecision(2).split(\"e\"), // get power\n      k = b.length === 1 ? 0 : Math.floor(Math.min(b[1].slice(1), 14) / 3), // floor at decimals, ceiling at trillions\n      c = k < 1 ? num.toFixed(0 + fixed) : (num / Math.pow(10, k * 3) ).toFixed(1 + fixed), // divide by power\n      d = c < 0 ? c : Math.abs(c), // enforce -0 is 0\n      e = d + ['', 'K', 'M', 'B', 'T'][k]; // append power\n  return e;\n  }\n  //dropdown handle methods\n \n  //swapping dropdown\n  const handleSwappingStationSelect =(e)=>{\n    setSwappingDropHeader(e.currentTarget.textContent);\n    setSwappingStation(e.target.value);\n  }\n \n  return (\n    <>\n     <Row>\n        <Colxx xxs=\"12\">\n         <span className=\"page_title\">Manager Dashboard</span>\n         <div className=\"btn-group float-right float-none-xs \">\n            <UncontrolledButtonDropdown>\n              <DropdownToggle\n                caret\n                color='primary'>\n                {swappingDropHeader}\n              </DropdownToggle>\n              <DropdownMenu>\n                <DropdownItem header>Stations</DropdownItem>\n                <DropdownItem key={0} value={0} onClick={e=>handleSwappingStationSelect(e)}>All Stations</DropdownItem>\n                {stationNameData.map((item,i) =>\n                  <DropdownItem key={i} value={item.hub_master_id} onClick={e=>handleSwappingStationSelect(e)}>{item.name}</DropdownItem>\n                )}\n              </DropdownMenu>\n            </UncontrolledButtonDropdown>\n          </div>\n         <Separator className=\"mb-5\" />\n        </Colxx>\n      </Row>     \n      <Row>\n        <Colxx lg=\"12\" xl=\"12\" md=\"12\">\n          <IconCardsCarousel />         \n        </Colxx>       \n      </Row>\n      <Row>\n        <Colxx lg=\"5\" xxs=\"12\" className=\"mb-5\">\n          <SwapChartCard />\n        </Colxx>\n        <Colxx lg=\"2\" xxs=\"12\" className=\"mb-2\">\n         <KPICards />\n        </Colxx>\n        <Colxx lg=\"5\" xxs=\"12\" className=\"mb-5\">\n          <EnergyChartCard />\n        </Colxx>\n      </Row>\n      <Row className=\"mb-12\">\n      <Colxx sm=\"12\" md=\"6\" lg=\"3\" className=\"mb-3\">\n        <StationDoughnut />\n      </Colxx>\n      <Colxx sm=\"12\" md=\"6\" lg=\"3\" className=\"mb-3\">\n        <ChargerDoughnut />\n      </Colxx>\n      <Colxx sm=\"12\" md=\"6\" lg=\"3\" className=\"mb-3\">\n        <BatteryStatusChart cardClass=\"dashboard-progress\"  />\n      </Colxx>    \n      <Colxx sm=\"12\" md=\"6\" lg=\"3\" className=\"mb-3\">\n        <ConnectorDoughnut />\n      </Colxx>       \n    </Row>\n    </>\n  );\n};\n\nexport default Mgr_dashboard;"]},"metadata":{},"sourceType":"module"}