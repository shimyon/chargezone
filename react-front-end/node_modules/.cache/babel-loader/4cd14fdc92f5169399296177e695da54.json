{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone-frontend-development\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Row,Card,CardBody,CardSubtitle,Table,Button,DropdownItem,DropdownMenu,DropdownToggle,UncontrolledDropdown,Alert,Modal,ModalHeader,ModalBody,Input,InputGroup}from'reactstrap';import{Colxx,Separator}from'../../../components/common/CustomBootstrap';import{getCurrentUser}from'../../../helpers/Utils';import{getBatteryInventoryListAPI,deleteBatteryInventoryAPI,adminRoot}from'../../../constants/defaultValues';import axios from'axios';import{useHistory,useLocation}from'react-router-dom';const Battery=()=>{//alert states\nconst _useState=useState(false),_useState2=_slicedToArray(_useState,2),alertVisible=_useState2[0],setAlertVisible=_useState2[1];const _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),alertMsg=_useState4[0],setAlertMsg=_useState4[1];const _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),alertColor=_useState6[0],setAlertColor=_useState6[1];//Modal States\nconst _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),modalVisible=_useState8[0],setModalVisible=_useState8[1];const _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),faultModalVisible=_useState10[0],setFaultModalVisible=_useState10[1];const _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),faultList=_useState12[0],setFaultList=_useState12[1];//search state\nconst _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),searchBy=_useState14[0],setSearchBy=_useState14[1];//Pagination states\nconst _useState15=useState(\"1\"),_useState16=_slicedToArray(_useState15,2),pageCount=_useState16[0],setPageCount=_useState16[1];const _useState17=useState(\"1\"),_useState18=_slicedToArray(_useState17,2),lastPageCount=_useState18[0],setLastPageCount=_useState18[1];//battery list\nconst _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),batteryInventoryList=_useState20[0],setBatteryInventoryList=_useState20[1];const _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),batteryInventoryID=_useState22[0],setBatteryInventoryID=_useState22[1];const _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),batteryInventoryToDeleteId=_useState24[0],setBatteryInventoryToDeleteId=_useState24[1];const _useState25=useState(true),_useState26=_slicedToArray(_useState25,2),isLoading=_useState26[0],setIsLoading=_useState26[1];const history=useHistory();const location=useLocation();useEffect(()=>{getBatteryInventoryListAPICall();batteryInventoryAlert();},[batteryInventoryID,pageCount]);//API calls\nconst getBatteryInventoryListAPICall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var currentUser;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setBatteryInventoryList([]);setIsLoading(true);currentUser=getCurrentUser();_context.next=5;return axios.get(getBatteryInventoryListAPI+pageCount+\"&search_param=\"+searchBy,{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){setLastPageCount(responseData.data.last_page);setBatteryInventoryList(responseData.data.data);}else{console.log(responseData.msg);}setIsLoading(false);}).catch(error=>{console.log(error);});case 5:case\"end\":return _context.stop();}},_callee);}));return function getBatteryInventoryListAPICall(){return _ref.apply(this,arguments);};}();const deleteBatteryInventoryAPICall=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(batteryInventoryId){var currentUser;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:setModalVisible(false);currentUser=getCurrentUser();_context2.next=4;return axios.post(deleteBatteryInventoryAPI,{battery_inventory_id:batteryInventoryId},{headers:{Authorization:\"Bearer \".concat(currentUser.token)}}).then(response=>{const responseData=response.data;if(responseData.status===1){setBatteryInventoryID(batteryInventoryId);batteryInventoryDeletedAlert(responseData.status,responseData.msg);}else{batteryInventoryDeletedAlert(responseData.status,responseData.msg);}}).catch(error=>{console.log(error);});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function deleteBatteryInventoryAPICall(_x){return _ref2.apply(this,arguments);};}();//Helper methods\nconst updateBatteryInventory=batteryInventoryId=>{history.push({pathname:adminRoot+'/inventory/updatebattery_inventory',state:{battery_inventory_id:batteryInventoryId}});};const renderPageList=()=>{const pageNumbers=[];for(let i=0;i<lastPageCount;i+=1){pageNumbers.push(/*#__PURE__*/React.createElement(DropdownItem,{key:i,onClick:()=>{setPageCount(i+1);}},i+1));}return pageNumbers;};//Alert helper methods\nconst batteryInventoryDeletedAlert=(status,msg)=>{setAlertVisible(true);setAlertMsg(msg);if(status===1){setAlertColor(\"success\");}else{setAlertColor(\"danger\");}};const onDismissAlert=()=>{setAlertVisible(false);};const batteryInventoryAlert=()=>{if(location.state===null||location.state===undefined){return;}else{if(location.state.responseStatus===1){setAlertVisible(true);setAlertMsg(location.state.responseMsg);setAlertColor(\"success\");history.replace({state:null});}else{setAlertVisible(true);setAlertMsg(location.state.responseMsg);setAlertColor(\"danger\");history.replace({state:null});}}};//Modal helper methods\nconst toggleModal=batteryInventoryId=>{setBatteryInventoryToDeleteId(batteryInventoryId);setModalVisible(!modalVisible);};const toggleFaultModal=faults=>{setFaultList(faults);setFaultModalVisible(!faultModalVisible);};//handle search input\nconst handleSearch=()=>{setPageCount(1);getBatteryInventoryListAPICall();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\"},/*#__PURE__*/React.createElement(\"span\",{className:\"page_title\"},\"Battery Inventory\"),/*#__PURE__*/React.createElement(\"a\",{href:\"addbattery\",className:\"mt-2 btn-primary default btn-sm float-right\"},/*#__PURE__*/React.createElement(\"b\",null,/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-plus\"}),\" Add New\")),/*#__PURE__*/React.createElement(Separator,{className:\"mb-5 mt-1\"}))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{md:\"4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"ml-2 mb-2\"},/*#__PURE__*/React.createElement(InputGroup,null,/*#__PURE__*/React.createElement(Input,{type:\"text\",placeholder:\"Search\",value:searchBy,onChange:e=>setSearchBy(e.target.value)}),/*#__PURE__*/React.createElement(Button,{className:\"default search-icon\",color:\"primary\",outline:true,onClick:()=>handleSearch()},/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-magnifier\"}))))),/*#__PURE__*/React.createElement(Colxx,{md:\"8\"},/*#__PURE__*/React.createElement(\"div\",{className:\"text-right mr-5 mb-2\"},/*#__PURE__*/React.createElement(\"span\",null,\"Page \"),/*#__PURE__*/React.createElement(UncontrolledDropdown,{className:\"d-inline-block\"},/*#__PURE__*/React.createElement(DropdownToggle,{caret:true,color:\"outline-primary\",size:\"xs\",\"data-display\":\"static\"},pageCount),/*#__PURE__*/React.createElement(DropdownMenu,{className:\"dropdownMenu\"},renderPageList())),/*#__PURE__*/React.createElement(\"span\",null,\" of \"),lastPageCount))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\",className:\"mb-4\"},/*#__PURE__*/React.createElement(Card,{className:\"mb-4\"},/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(CardSubtitle,{className:\"mb-3\"},/*#__PURE__*/React.createElement(Alert,{color:alertColor,isOpen:alertVisible,toggle:onDismissAlert},alertMsg)),/*#__PURE__*/React.createElement(Table,{responsive:true,bordered:true,striped:true},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"#\"),/*#__PURE__*/React.createElement(\"th\",null,\"BIN\"),/*#__PURE__*/React.createElement(\"th\",null,\"QR Code\"),/*#__PURE__*/React.createElement(\"th\",null,\"OEM\"),/*#__PURE__*/React.createElement(\"th\",null,\"Model Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Make Year\"),/*#__PURE__*/React.createElement(\"th\",null,\"Owned By\"),/*#__PURE__*/React.createElement(\"th\",null,\"Serial Number\"),/*#__PURE__*/React.createElement(\"th\",null,\"IMEI\"),/*#__PURE__*/React.createElement(\"th\",null,\"SOC\"),/*#__PURE__*/React.createElement(\"th\",null,\"BV\"),/*#__PURE__*/React.createElement(\"th\",null,\"Rec\"),/*#__PURE__*/React.createElement(\"th\",null,\"Latitude\"),/*#__PURE__*/React.createElement(\"th\",null,\"Longitude\"),/*#__PURE__*/React.createElement(\"th\",null,\"Faults\"),/*#__PURE__*/React.createElement(\"th\",null,\"Remark\"),/*#__PURE__*/React.createElement(\"th\",null,\"Action\"))),/*#__PURE__*/React.createElement(\"tbody\",null,isLoading?/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"text-center\",colSpan:\"17\"},/*#__PURE__*/React.createElement(\"div\",{className:\"custom-list-loading\"}))):batteryInventoryList.length>0?batteryInventoryList.map((item,index)=>/*#__PURE__*/React.createElement(\"tr\",{key:index},/*#__PURE__*/React.createElement(\"th\",{scope:\"row\"},pageCount==1?index+1:(pageCount-1)*10+index+1),/*#__PURE__*/React.createElement(\"td\",null,item.bin),/*#__PURE__*/React.createElement(\"td\",null,item.b_qr_code),/*#__PURE__*/React.createElement(\"td\",null,item.oem_name),/*#__PURE__*/React.createElement(\"td\",null,item.model_name),/*#__PURE__*/React.createElement(\"td\",null,item.make_year),/*#__PURE__*/React.createElement(\"td\",null,item.owner_name),/*#__PURE__*/React.createElement(\"td\",null,item.serial_number),/*#__PURE__*/React.createElement(\"td\",null,item.imei),/*#__PURE__*/React.createElement(\"td\",null,item.soc),/*#__PURE__*/React.createElement(\"td\",null,item.bv),/*#__PURE__*/React.createElement(\"td\",null,item.rec),/*#__PURE__*/React.createElement(\"td\",null,item.lat),/*#__PURE__*/React.createElement(\"td\",null,item.lon),/*#__PURE__*/React.createElement(\"td\",null,item.total_alarm>0?/*#__PURE__*/React.createElement(Button,{color:\"info\",className:\"default mr-1 btn-sm tbl_action_btn\",onClick:()=>{toggleFaultModal(item.alarm_list);}},/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-eye\"})):\"None\"),/*#__PURE__*/React.createElement(\"td\",null,item.remark),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"a\",{className:\"btn-info default mr-1 btn-sm tbl_action_a\",onClick:()=>{updateBatteryInventory(item.battery_inventory_id);}},/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-pencil text-white\"})),/*#__PURE__*/React.createElement(Button,{color:\"danger\",className:\"default btn-sm tbl_action_btn\",onClick:()=>{toggleModal(item.battery_inventory_id);}},/*#__PURE__*/React.createElement(\"i\",{className:\"glyph-icon simple-icon-trash\"}))))):/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"text-center text-danger\",colSpan:\"17\"},\"Data  Not  Found\")))),/*#__PURE__*/React.createElement(Modal,{isOpen:modalVisible,toggle:toggleModal},/*#__PURE__*/React.createElement(ModalHeader,{className:\"text-center\"},\"Are you sure you would like to delete this inventory?\",/*#__PURE__*/React.createElement(Button,{color:\"success\",className:\"mt-4\",onClick:()=>deleteBatteryInventoryAPICall(batteryInventoryToDeleteId)},\"Delete Inventory\"),' ',/*#__PURE__*/React.createElement(Button,{color:\"danger\",className:\"mt-4 mr-2\",onClick:toggleModal},\"Cancel\"))),/*#__PURE__*/React.createElement(Modal,{isOpen:faultModalVisible,toggle:toggleFaultModal},/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(\"h2\",{className:\"text-center\"},\"Faults\"),faultList.length>0&&faultList.map((item,index)=>/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{md:\"12\"},index+\". \"+item.title))),/*#__PURE__*/React.createElement(Row,{className:\"text-center\"},/*#__PURE__*/React.createElement(Colxx,null,/*#__PURE__*/React.createElement(Button,{color:\"danger\",className:\"mt-4 mr-2\",onClick:()=>setFaultModalVisible(false)},\"Cancel\"))))))))));};export default Battery;","map":{"version":3,"sources":["D:/Shimyon/Emoiss/RiteshBhai/cdzb/chargezone-frontend-development/src/views/app/inventory/Battery.js"],"names":["React","useState","useEffect","Row","Card","CardBody","CardSubtitle","Table","Button","DropdownItem","DropdownMenu","DropdownToggle","UncontrolledDropdown","Alert","Modal","ModalHeader","ModalBody","Input","InputGroup","Colxx","Separator","getCurrentUser","getBatteryInventoryListAPI","deleteBatteryInventoryAPI","adminRoot","axios","useHistory","useLocation","Battery","alertVisible","setAlertVisible","alertMsg","setAlertMsg","alertColor","setAlertColor","modalVisible","setModalVisible","faultModalVisible","setFaultModalVisible","faultList","setFaultList","searchBy","setSearchBy","pageCount","setPageCount","lastPageCount","setLastPageCount","batteryInventoryList","setBatteryInventoryList","batteryInventoryID","setBatteryInventoryID","batteryInventoryToDeleteId","setBatteryInventoryToDeleteId","isLoading","setIsLoading","history","location","getBatteryInventoryListAPICall","batteryInventoryAlert","currentUser","get","headers","Authorization","token","then","response","responseData","data","status","last_page","console","log","msg","catch","error","deleteBatteryInventoryAPICall","batteryInventoryId","post","battery_inventory_id","batteryInventoryDeletedAlert","updateBatteryInventory","push","pathname","state","renderPageList","pageNumbers","i","onDismissAlert","undefined","responseStatus","responseMsg","replace","toggleModal","toggleFaultModal","faults","handleSearch","e","target","value","length","map","item","index","bin","b_qr_code","oem_name","model_name","make_year","owner_name","serial_number","imei","soc","bv","rec","lat","lon","total_alarm","alarm_list","remark","title"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport { \n  Row, Card, CardBody,CardSubtitle, Table, Button,\n  DropdownItem,\n  DropdownMenu,\n  DropdownToggle,\n  UncontrolledDropdown,\n  Alert,\n  Modal,ModalHeader,ModalBody,\n  Input,InputGroup, \n } from 'reactstrap';\nimport { Colxx, Separator } from '../../../components/common/CustomBootstrap';\nimport { getCurrentUser } from '../../../helpers/Utils'\nimport {getBatteryInventoryListAPI,deleteBatteryInventoryAPI, adminRoot} from '../../../constants/defaultValues'\nimport axios from 'axios';\nimport {useHistory,useLocation} from 'react-router-dom';\n\n\nconst Battery = () => {\n  //alert states\n  const [alertVisible,setAlertVisible] = useState(false);\n  const [alertMsg,setAlertMsg] = useState(\"\");\n  const [alertColor,setAlertColor] = useState(\"\");\n  //Modal States\n  const [modalVisible,setModalVisible] = useState(false);\n  const [faultModalVisible,setFaultModalVisible] = useState(false);\n  const [faultList,setFaultList] = useState([]);\n  //search state\n  const [searchBy,setSearchBy] = useState(\"\");\n  //Pagination states\n  const [pageCount,setPageCount] = useState(\"1\");\n  const [lastPageCount,setLastPageCount] = useState(\"1\");\n  //battery list\n  const [batteryInventoryList,setBatteryInventoryList] = useState([]);\n  const [batteryInventoryID,setBatteryInventoryID] = useState(\"\");\n  const [batteryInventoryToDeleteId,setBatteryInventoryToDeleteId] = useState(\"\");\n  const [isLoading,setIsLoading] = useState(true);\n\n  const history = useHistory();\n  const location = useLocation();\n\n  useEffect(()=>{\n    getBatteryInventoryListAPICall();\n    batteryInventoryAlert();\n  },[batteryInventoryID,pageCount])\n\n  //API calls\n  const getBatteryInventoryListAPICall = async() => {\n    setBatteryInventoryList([]);\n    setIsLoading(true);\n    const currentUser = getCurrentUser();\n    await axios.get(getBatteryInventoryListAPI+pageCount+`&search_param=`+searchBy,\n      {headers:{Authorization: `Bearer ${currentUser.token}`}})\n      .then(response=>{\n        const responseData = response.data;\n        if (responseData.status === 1) {\n          setLastPageCount(responseData.data.last_page)\n          setBatteryInventoryList(responseData.data.data);\n        }else{\n          console.log(responseData.msg);\n        }\n        setIsLoading(false);\n      }).catch(error=>{\n        console.log(error);\n      })\n  }\n\n  const deleteBatteryInventoryAPICall = async(batteryInventoryId) =>{\n    setModalVisible(false);\n    const currentUser = getCurrentUser();\n    await axios.post(deleteBatteryInventoryAPI,\n      {battery_inventory_id:batteryInventoryId},\n      {headers:{Authorization: `Bearer ${currentUser.token}`}})\n      .then(response=>{\n        const responseData = response.data;\n        if (responseData.status === 1) {\n          setBatteryInventoryID(batteryInventoryId);\n          batteryInventoryDeletedAlert(responseData.status,responseData.msg)\n        }else{\n          batteryInventoryDeletedAlert(responseData.status,responseData.msg)\n        }\n      }).catch(error=>{\n        console.log(error);\n      })\n  }\n\n  //Helper methods\n  const updateBatteryInventory = (batteryInventoryId) => {\n    history.push({\n      pathname:adminRoot+'/inventory/updatebattery_inventory',\n      state:{battery_inventory_id:batteryInventoryId}\n    });\n  }\n  const renderPageList = () => {\n    const pageNumbers = [];\n    for (let i = 0; i <lastPageCount; i += 1) {\n      pageNumbers.push(\n        <DropdownItem key={i} onClick={() => {setPageCount(i+1)}}>\n          {i+1}\n        </DropdownItem>\n      );\n    }\n    return pageNumbers;\n  };\n  //Alert helper methods\n  const batteryInventoryDeletedAlert = (status,msg)=>{\n    setAlertVisible(true);\n    setAlertMsg(msg);\n    if (status === 1) {\n      setAlertColor(\"success\");\n    } else {\n      setAlertColor(\"danger\");\n    }\n  }\n  const onDismissAlert = ()=>{\n    setAlertVisible(false);\n  }\n  const batteryInventoryAlert = () =>{\n    if (location.state === null || location.state === undefined) {\n      return;\n    }else{\n      if (location.state.responseStatus === 1) {\n        setAlertVisible(true);\n        setAlertMsg(location.state.responseMsg);\n        setAlertColor(\"success\");\n        history.replace({\n          state: null,\n        })\n      }else{\n        setAlertVisible(true);\n        setAlertMsg(location.state.responseMsg);\n        setAlertColor(\"danger\");\n        history.replace({\n          state: null,\n        })\n      }\n    }\n  }\n  //Modal helper methods\n  const toggleModal = (batteryInventoryId) => {\n    setBatteryInventoryToDeleteId(batteryInventoryId)\n    setModalVisible(!modalVisible);\n  }\n  const toggleFaultModal = (faults) => {\n    setFaultList(faults)\n    setFaultModalVisible(!faultModalVisible);\n  }\n  //handle search input\n  const handleSearch = () => {\n      setPageCount(1);\n      getBatteryInventoryListAPICall();\n  }\n\n  return (\n    <>\n      <Row>\n        <Colxx xxs=\"12\">\n        <span className=\"page_title\">Battery Inventory</span>\n        <a href=\"addbattery\" className=\"mt-2 btn-primary default btn-sm float-right\">\n                <b><i className=\"glyph-icon simple-icon-plus\"></i> Add New</b>\n            </a>\n          <Separator className=\"mb-5 mt-1\" />\n        </Colxx>\n      </Row>\n      <Row>\n        <Colxx md=\"4\">\n          <div className=\"ml-2 mb-2\">\n            <InputGroup>\n            <Input \n            type=\"text\" \n            placeholder=\"Search\"\n            value={searchBy}\n            onChange={e=>setSearchBy(e.target.value)}/>\n            <Button className=\"default search-icon\" color=\"primary\" outline onClick={()=>handleSearch()}><i className=\"glyph-icon simple-icon-magnifier\"></i></Button>\n            </InputGroup>  \n          </div>\n        </Colxx>\n        <Colxx md=\"8\">\n            <div className=\"text-right mr-5 mb-2\">\n              <span>Page </span>\n              <UncontrolledDropdown className=\"d-inline-block\">\n                <DropdownToggle caret color=\"outline-primary\" size=\"xs\" data-display=\"static\">\n                  {pageCount}\n                </DropdownToggle>\n                <DropdownMenu className=\"dropdownMenu\">\n                  {renderPageList()}\n                </DropdownMenu>\n              </UncontrolledDropdown>\n              <span> of </span>\n              {lastPageCount}\n            </div>\n        </Colxx>\n      </Row>\n      <Row>\n        <Colxx xxs=\"12\" className=\"mb-4\">\n          <Card className=\"mb-4\">\n              <CardBody>\n                <CardSubtitle className=\"mb-3\">\n                    <Alert color={alertColor} isOpen={alertVisible} toggle={onDismissAlert}>\n                      {alertMsg}\n                    </Alert>\n                </CardSubtitle> \n                <Table responsive bordered striped>\n                  <thead>\n                    <tr>\n                      <th>#</th>\n                      <th>BIN</th>\n                      <th>QR Code</th>\n                      <th>OEM</th>\n                      <th>Model Name</th>\n                      <th>Make Year</th>\n                      <th>Owned By</th>\n                      <th>Serial Number</th>\n                      <th>IMEI</th>\n                      <th>SOC</th>\n                      <th>BV</th>\n                      <th>Rec</th>\n                      <th>Latitude</th>\n                      <th>Longitude</th>\n                      <th>Faults</th>\n                      <th>Remark</th>\n                      <th>Action</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  {isLoading ?\n                      <tr>\n                          <td className=\"text-center\" colSpan=\"17\"><div className=\"custom-list-loading\" /></td>\n                      </tr> : \n                         batteryInventoryList.length > 0 ?\n                          batteryInventoryList.map((item,index)=>\n                            <tr key={index}>\n                                <th scope=\"row\">{pageCount==1?index+1:(pageCount-1)*10+index +1}</th>\n                                <td>{item.bin}</td>\n                                <td>{item.b_qr_code}</td>\n                                <td>{item.oem_name}</td>\n                                <td>{item.model_name}</td>\n                                <td>{item.make_year}</td>\n                                <td>{item.owner_name}</td>\n                                <td>{item.serial_number}</td>\n                                <td>{item.imei}</td>\n                                <td>{item.soc}</td>\n                                <td>{item.bv}</td>\n                                <td>{item.rec}</td>\n                                <td>{item.lat}</td>\n                                <td>{item.lon}</td>\n                                <td>{item.total_alarm>0?\n                                    <Button color=\"info\" className=\"default mr-1 btn-sm tbl_action_btn\" onClick={()=>{toggleFaultModal(item.alarm_list)}}>\n                                      <i className=\"glyph-icon simple-icon-eye\"></i>\n                                    </Button>:\"None\"}</td>\n                                <td>{item.remark}</td>\n                                <td>\n                                  <a className=\"btn-info default mr-1 btn-sm tbl_action_a\" onClick={()=>{updateBatteryInventory(item.battery_inventory_id)}}>\n                                      <i className=\"glyph-icon simple-icon-pencil text-white\"></i>\n                                  </a>\n                                  <Button color=\"danger\" className=\"default btn-sm tbl_action_btn\" onClick={()=>{toggleModal(item.battery_inventory_id)}}>\n                                      <i className=\"glyph-icon simple-icon-trash\"></i>\n                                  </Button>                        \n                                </td>\n                            </tr>\n                      ):<tr>\n                            <td className=\"text-center text-danger\" colSpan=\"17\">Data  Not  Found</td>\n                        </tr>\n                      }          \n                  </tbody>\n                </Table>\n                <Modal\n                  isOpen={modalVisible}\n                  toggle={toggleModal} >\n                  <ModalHeader className=\"text-center\">\n                    Are you sure you would like to delete this inventory?\n                    <Button color=\"success\" className=\"mt-4\" onClick={()=>deleteBatteryInventoryAPICall(batteryInventoryToDeleteId)}>\n                      Delete Inventory \n                    </Button>{' '}\n                    <Button color=\"danger\" className=\"mt-4 mr-2\" onClick={toggleModal}>\n                      Cancel\n                    </Button>\n                  </ModalHeader>\n                </Modal>\n                <Modal\n                  isOpen={faultModalVisible}\n                  toggle={toggleFaultModal} >\n                  <ModalBody>\n                    <h2 className=\"text-center\">Faults</h2>\n                    \n                    {faultList.length>0 &&\n                      faultList.map((item,index)=>\n                      <Row>\n                        <Colxx md=\"12\">\n                          {index+\". \"+item.title}\n                        </Colxx>\n                      </Row>)\n                    }\n                    <Row className=\"text-center\">\n                      <Colxx>\n                        <Button color=\"danger\" className=\"mt-4 mr-2\" onClick={()=>setFaultModalVisible(false)}>\n                          Cancel\n                        </Button>\n                      </Colxx>\n                    </Row> \n                  </ModalBody>\n                </Modal>\n              </CardBody>\n            </Card>\n        </Colxx>\n      </Row>\n    </>\n  );\n};\n\nexport default Battery;\n"]},"metadata":{},"sourceType":"module"}