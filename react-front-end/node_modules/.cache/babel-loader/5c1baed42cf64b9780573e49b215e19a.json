{"ast":null,"code":"import _objectSpread from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _regeneratorRuntime from\"D:\\\\Shimyon\\\\Emoiss\\\\RiteshBhai\\\\cdzb\\\\chargezone\\\\react-front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(watchLoginUser),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(loginWithEmailPassword),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(watchRegisterUser),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(registerWithEmailPassword),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(watchLogoutUser),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(logout),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(watchForgotPassword),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(forgotPassword),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(watchResetPassword),_marked10=/*#__PURE__*/_regeneratorRuntime.mark(resetPassword),_marked11=/*#__PURE__*/_regeneratorRuntime.mark(rootSaga);import{all,call,fork,put,takeEvery}from'redux-saga/effects';import{auth}from'../../helpers/Firebase';import axios from'axios';import{LOGIN_USER,REGISTER_USER,LOGOUT_USER,FORGOT_PASSWORD,RESET_PASSWORD}from'../actions';import{loginUserSuccess,loginUserError,registerUserSuccess,registerUserError,forgotPasswordSuccess,forgotPasswordError,resetPasswordSuccess,resetPasswordError}from'./actions';import{adminRoot,currentUser,loginAPI}from\"../../constants/defaultValues\";import{setCurrentUser,getCurrentUser}from'../../helpers/Utils';export function watchLoginUser(){return _regeneratorRuntime.wrap(function watchLoginUser$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return takeEvery(LOGIN_USER,loginWithEmailPassword);case 2:case\"end\":return _context.stop();}},_marked);}const loginWithEmailPasswordAsync=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(credentials){return _regeneratorRuntime.wrap(function _callee$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(loginAPI,credentials).then(user=>user).catch(res=>{//console.log(res);\n});case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}},_callee);}));return function loginWithEmailPasswordAsync(_x){return _ref.apply(this,arguments);};}();function loginWithEmailPassword({payload}){var _payload$user,email,password,history,credentials,loginUser,item;return _regeneratorRuntime.wrap(function loginWithEmailPassword$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_payload$user=payload.user,email=_payload$user.email,password=_payload$user.password;history=payload.history;credentials=new FormData();credentials.append(\"username\",email);credentials.append(\"password\",password);_context3.prev=5;_context3.next=8;return call(loginWithEmailPasswordAsync,credentials);case 8:loginUser=_context3.sent;if(!(loginUser.data.status===1)){_context3.next=17;break;}//const item = { uid: loginUser.user.uid, ...currentUser };\nitem=loginUser.data.data;setCurrentUser(item);_context3.next=14;return put(loginUserSuccess(item));case 14:if(item.roles[0]==1){history.push(adminRoot+\"/dashboard/operator\");}else if(item.roles[0]==4){history.push(adminRoot+\"/dashboard/manager\");}else if(item.roles[0]==3){history.push(adminRoot+\"/dashboard/admin\");}else{//history.push(adminRoot+\"/gogo/start\");\n}_context3.next=19;break;case 17:_context3.next=19;return put(loginUserError(loginUser.data.msg));case 19:_context3.next=25;break;case 21:_context3.prev=21;_context3.t0=_context3[\"catch\"](5);_context3.next=25;return put(loginUserError(_context3.t0));case 25:case\"end\":return _context3.stop();}},_marked2,null,[[5,21]]);}export function watchRegisterUser(){return _regeneratorRuntime.wrap(function watchRegisterUser$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return takeEvery(REGISTER_USER,registerWithEmailPassword);case 2:case\"end\":return _context4.stop();}},_marked3);}const registerWithEmailPasswordAsync=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(email,password){return _regeneratorRuntime.wrap(function _callee2$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return auth.createUserWithEmailAndPassword(email,password).then(user=>user).catch(error=>error);case 2:return _context5.abrupt(\"return\",_context5.sent);case 3:case\"end\":return _context5.stop();}},_callee2);}));return function registerWithEmailPasswordAsync(_x2,_x3){return _ref2.apply(this,arguments);};}();function registerWithEmailPassword({payload}){var _payload$user2,email,password,history,registerUser,item;return _regeneratorRuntime.wrap(function registerWithEmailPassword$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_payload$user2=payload.user,email=_payload$user2.email,password=_payload$user2.password;history=payload.history;_context6.prev=2;_context6.next=5;return call(registerWithEmailPasswordAsync,email,password);case 5:registerUser=_context6.sent;if(registerUser.message){_context6.next=14;break;}item=_objectSpread({uid:registerUser.user.uid},currentUser);setCurrentUser(item);_context6.next=11;return put(registerUserSuccess(item));case 11:history.push(adminRoot);_context6.next=16;break;case 14:_context6.next=16;return put(registerUserError(registerUser.message));case 16:_context6.next=22;break;case 18:_context6.prev=18;_context6.t0=_context6[\"catch\"](2);_context6.next=22;return put(registerUserError(_context6.t0));case 22:case\"end\":return _context6.stop();}},_marked4,null,[[2,18]]);}export function watchLogoutUser(){return _regeneratorRuntime.wrap(function watchLogoutUser$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeEvery(LOGOUT_USER,logout);case 2:case\"end\":return _context7.stop();}},_marked5);}const logoutAsync=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(history){return _regeneratorRuntime.wrap(function _callee3$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.next=2;return auth.signOut().then(user=>user).catch(error=>error);case 2:history.push(adminRoot);case 3:case\"end\":return _context8.stop();}},_callee3);}));return function logoutAsync(_x4){return _ref3.apply(this,arguments);};}();function logout({payload}){var history;return _regeneratorRuntime.wrap(function logout$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:history=payload.history;setCurrentUser();_context9.next=4;return call(logoutAsync,history);case 4:case\"end\":return _context9.stop();}},_marked6);}export function watchForgotPassword(){return _regeneratorRuntime.wrap(function watchForgotPassword$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:_context10.next=2;return takeEvery(FORGOT_PASSWORD,forgotPassword);case 2:case\"end\":return _context10.stop();}},_marked7);}const forgotPasswordAsync=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(email){return _regeneratorRuntime.wrap(function _callee4$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:_context11.next=2;return auth.sendPasswordResetEmail(email).then(user=>user).catch(error=>error);case 2:return _context11.abrupt(\"return\",_context11.sent);case 3:case\"end\":return _context11.stop();}},_callee4);}));return function forgotPasswordAsync(_x5){return _ref4.apply(this,arguments);};}();function forgotPassword({payload}){var email,forgotPasswordStatus;return _regeneratorRuntime.wrap(function forgotPassword$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:email=payload.forgotUserMail.email;_context12.prev=1;_context12.next=4;return call(forgotPasswordAsync,email);case 4:forgotPasswordStatus=_context12.sent;if(forgotPasswordStatus){_context12.next=10;break;}_context12.next=8;return put(forgotPasswordSuccess('success'));case 8:_context12.next=12;break;case 10:_context12.next=12;return put(forgotPasswordError(forgotPasswordStatus.message));case 12:_context12.next=18;break;case 14:_context12.prev=14;_context12.t0=_context12[\"catch\"](1);_context12.next=18;return put(forgotPasswordError(_context12.t0));case 18:case\"end\":return _context12.stop();}},_marked8,null,[[1,14]]);}export function watchResetPassword(){return _regeneratorRuntime.wrap(function watchResetPassword$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:_context13.next=2;return takeEvery(RESET_PASSWORD,resetPassword);case 2:case\"end\":return _context13.stop();}},_marked9);}const resetPasswordAsync=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(resetPasswordCode,newPassword){return _regeneratorRuntime.wrap(function _callee5$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:_context14.next=2;return auth.confirmPasswordReset(resetPasswordCode,newPassword).then(user=>user).catch(error=>error);case 2:return _context14.abrupt(\"return\",_context14.sent);case 3:case\"end\":return _context14.stop();}},_callee5);}));return function resetPasswordAsync(_x6,_x7){return _ref5.apply(this,arguments);};}();function resetPassword({payload}){var newPassword,resetPasswordCode,resetPasswordStatus;return _regeneratorRuntime.wrap(function resetPassword$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:newPassword=payload.newPassword,resetPasswordCode=payload.resetPasswordCode;_context15.prev=1;_context15.next=4;return call(resetPasswordAsync,resetPasswordCode,newPassword);case 4:resetPasswordStatus=_context15.sent;if(resetPasswordStatus){_context15.next=10;break;}_context15.next=8;return put(resetPasswordSuccess('success'));case 8:_context15.next=12;break;case 10:_context15.next=12;return put(resetPasswordError(resetPasswordStatus.message));case 12:_context15.next=18;break;case 14:_context15.prev=14;_context15.t0=_context15[\"catch\"](1);_context15.next=18;return put(resetPasswordError(_context15.t0));case 18:case\"end\":return _context15.stop();}},_marked10,null,[[1,14]]);}export default function rootSaga(){return _regeneratorRuntime.wrap(function rootSaga$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:_context16.next=2;return all([fork(watchLoginUser),fork(watchLogoutUser),fork(watchRegisterUser),fork(watchForgotPassword),fork(watchResetPassword)]);case 2:case\"end\":return _context16.stop();}},_marked11);}","map":{"version":3,"sources":["D:/Shimyon/Emoiss/RiteshBhai/cdzb/chargezone/react-front-end/src/redux/auth/saga.js"],"names":["watchLoginUser","loginWithEmailPassword","watchRegisterUser","registerWithEmailPassword","watchLogoutUser","logout","watchForgotPassword","forgotPassword","watchResetPassword","resetPassword","rootSaga","all","call","fork","put","takeEvery","auth","axios","LOGIN_USER","REGISTER_USER","LOGOUT_USER","FORGOT_PASSWORD","RESET_PASSWORD","loginUserSuccess","loginUserError","registerUserSuccess","registerUserError","forgotPasswordSuccess","forgotPasswordError","resetPasswordSuccess","resetPasswordError","adminRoot","currentUser","loginAPI","setCurrentUser","getCurrentUser","loginWithEmailPasswordAsync","credentials","post","then","user","catch","res","payload","email","password","history","FormData","append","loginUser","data","status","item","roles","push","msg","registerWithEmailPasswordAsync","createUserWithEmailAndPassword","error","registerUser","message","uid","logoutAsync","signOut","forgotPasswordAsync","sendPasswordResetEmail","forgotUserMail","forgotPasswordStatus","resetPasswordAsync","resetPasswordCode","newPassword","confirmPasswordReset","resetPasswordStatus"],"mappings":"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","sourcesContent":["import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\nimport { auth } from '../../helpers/Firebase';\nimport axios from 'axios';\n\nimport {\n  LOGIN_USER,\n  REGISTER_USER,\n  LOGOUT_USER,\n  FORGOT_PASSWORD,\n  RESET_PASSWORD,\n} from '../actions';\n\nimport {\n  loginUserSuccess,\n  loginUserError,\n  registerUserSuccess,\n  registerUserError,\n  forgotPasswordSuccess,\n  forgotPasswordError,\n  resetPasswordSuccess,\n  resetPasswordError,\n} from './actions';\n\nimport { adminRoot, currentUser,loginAPI } from \"../../constants/defaultValues\"\nimport { setCurrentUser,getCurrentUser } from '../../helpers/Utils';\n\nexport function* watchLoginUser() {\n  yield takeEvery(LOGIN_USER, loginWithEmailPassword);\n}\n\nconst loginWithEmailPasswordAsync = async (credentials) =>\n \n\n\n  await  axios.post(loginAPI,  credentials )\n      .then((user) => user)\n      .catch(res => {\n        //console.log(res);\n      });\n\nfunction* loginWithEmailPassword({ payload }) {\n  const { email, password } = payload.user;\n  const { history } = payload;\n     const credentials = new FormData();\n      credentials.append(\"username\", email);\n      credentials.append(\"password\", password);\n  try {\n    const loginUser = yield call(loginWithEmailPasswordAsync, credentials);\n     // const item = { uid: loginUser.data.msg, ...currentUser };\n     // const item = { uid: loginUser.data.userdetail.id,...currentUser };\n    if (loginUser.data.status===1) {\n      //const item = { uid: loginUser.user.uid, ...currentUser };\n      const item = loginUser.data.data;\n      setCurrentUser(item);\n      yield put(loginUserSuccess(item));\n      if(item.roles[0] == 1){\n        history.push(adminRoot+\"/dashboard/operator\");\n      }\n      else if(item.roles[0] == 4){\n        history.push(adminRoot+\"/dashboard/manager\");\n      }\n      else if(item.roles[0] == 3){\n        history.push(adminRoot+\"/dashboard/admin\");\n      }\n      else{\n        //history.push(adminRoot+\"/gogo/start\");\n      } \n    } else {\n      yield put(loginUserError(loginUser.data.msg));\n    }\n  } catch (error) {\n    yield put(loginUserError(error));\n  }\n}\n\nexport function* watchRegisterUser() {\n  yield takeEvery(REGISTER_USER, registerWithEmailPassword);\n}\n\nconst registerWithEmailPasswordAsync = async (email, password) =>\n  await auth\n    .createUserWithEmailAndPassword(email, password)\n    .then((user) => user)\n    .catch((error) => error);\n\nfunction* registerWithEmailPassword({ payload }) {\n  const { email, password } = payload.user;\n  const { history } = payload;\n  try {\n    const registerUser = yield call(\n      registerWithEmailPasswordAsync,\n      email,\n      password\n    );\n    if (!registerUser.message) {\n      const item = { uid: registerUser.user.uid, ...currentUser };\n      setCurrentUser(item);\n      yield put(registerUserSuccess(item));\n      history.push(adminRoot);\n    } else {\n      yield put(registerUserError(registerUser.message));\n    }\n  } catch (error) {\n    yield put(registerUserError(error));\n  }\n}\n\nexport function* watchLogoutUser() {\n  yield takeEvery(LOGOUT_USER, logout);\n}\n\nconst logoutAsync = async (history) => {\n  await auth\n    .signOut()\n    .then((user) => user)\n    .catch((error) => error);\n  history.push(adminRoot);\n};\n\nfunction* logout({ payload }) {\n  const { history } = payload;\n  setCurrentUser();\n  yield call(logoutAsync, history);\n}\n\nexport function* watchForgotPassword() {\n  yield takeEvery(FORGOT_PASSWORD, forgotPassword);\n}\n\nconst forgotPasswordAsync = async (email) => {\n  return await auth\n    .sendPasswordResetEmail(email)\n    .then((user) => user)\n    .catch((error) => error);\n};\n\nfunction* forgotPassword({ payload }) {\n  const { email } = payload.forgotUserMail;\n  try {\n    const forgotPasswordStatus = yield call(forgotPasswordAsync, email);\n    if (!forgotPasswordStatus) {\n      yield put(forgotPasswordSuccess('success'));\n    } else {\n      yield put(forgotPasswordError(forgotPasswordStatus.message));\n    }\n  } catch (error) {\n    yield put(forgotPasswordError(error));\n  }\n}\n\nexport function* watchResetPassword() {\n  yield takeEvery(RESET_PASSWORD, resetPassword);\n}\n\nconst resetPasswordAsync = async (resetPasswordCode, newPassword) => {\n  return await auth\n    .confirmPasswordReset(resetPasswordCode, newPassword)\n    .then((user) => user)\n    .catch((error) => error);\n};\n\nfunction* resetPassword({ payload }) {\n  const { newPassword, resetPasswordCode } = payload;\n  try {\n    const resetPasswordStatus = yield call(\n      resetPasswordAsync,\n      resetPasswordCode,\n      newPassword\n    );\n    if (!resetPasswordStatus) {\n      yield put(resetPasswordSuccess('success'));\n    } else {\n      yield put(resetPasswordError(resetPasswordStatus.message));\n    }\n  } catch (error) {\n    yield put(resetPasswordError(error));\n  }\n}\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchLoginUser),\n    fork(watchLogoutUser),\n    fork(watchRegisterUser),\n    fork(watchForgotPassword),\n    fork(watchResetPassword),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}